<article itemscope itemtype="http://schema.org/JobPosting">
  <h1 itemprop="title"><%= @job.title %></h1>
  <div><%= link_to(@job.employer.name, @job.employer, itemprop: 'hiringOrganization') if @job.employer %> - <span itemprop="jobLocation"><%= @job.location %></span></div>

  <% if @job.employer %>
    <small><%= @job.employer.jobs.recent.where.not(id: @job.id).count %> other recent jobs</small>
  <% end %>
  <hr />

  <div class="row">
    <div class="col-md-8" itemprop="description">
      <%= render_marked_up_description @job.description, format: @job.description_markup %>
    </div>

    <div class="col-md-4">
      <p>
        <span itemprop="employmentType"><%= render_job_badge(@job) %></span>
        <% if @job.telecommute? %>
          <span class="badge badge-info">Remote / Telecommute</span>
        <% end %>
      </p>

    <p itemprop="skills">
      <% @job.tags.each do |tag| %>
        <%= link_to tag.name, tag_path(tag.name), class: 'badge badge-default' %>
      <% end %>
    </p>

    <h3>How to apply</h3>

    <% if @job.url.present? %>
    <p>
      <%= link_to @job.url, @job.url, itemprop: 'url' %>
    </p>
    <% end %>

    <% if @job.contact.present? %>
    <p>
      <strong>Contact:</strong>
      <%= @job.contact %>
    </p>
    <% end %>

    <h3 class="h5">Metadata</h3>

    <% if @job.user %>
    <p>
      <strong>Submitted by:</strong>
      <%= @job.user&.uid %>
    </p>
    <% end %>

    <p>
      <strong>Created:</strong>
      <span itemprop="datePosted"><%= l(@job.created_at) %></span>
    </p>

    <% if @job.created_at != @job.updated_at %>
    <p>
      <strong>Updated:</strong>
      <%= l(@job.updated_at) %>
    </p>
    <% end %>

    <% if @job.published? %>
    <p>
      <strong>Published:</strong>
      <%= l(@job.published_at) %>
    </p>
    <% else %>
    <p>
      <span class="badge badge-danger">Unpublished</span>
      <% if can? :manage, @job %>
        <%= link_to 'Publish', publish_job_path(@job), class: 'btn btn-primary publish', remote: true %>
      <% end %>
    </p>
    <% end %>

    <% if can? :edit, @job %>
      <%= link_to 'Edit', edit_job_path(@job), class: 'btn btn-primary' %>
    <% end %>
    </div>
  </div>
</article>
